REM  QBFC Project Options Begin
REM  HasVersionInfo: Yes
REM  Companyname: by Osku & Faguss
REM  Productname: Operation Finnishpoint
REM  Filedescription: Setup
REM  Copyrights: None
REM  Trademarks: None
REM  Originalname: Install_FIN.exe
REM  Comments: Finnish localization for OFP
REM  Productversion:  0. 8. 0. 0
REM  Fileversion:  1. 0. 2. 5
REM  Internalname: None
REM  Appicon: D:\Dokumenty\FinnishPoint\Finland.ico
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\1-6_C_LostSquad.Abelbriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\1-6_C_LostSquad.Abelstringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\1-7_C_OilWar.Edenbriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\1-7_C_OilWar.Edenstringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\1-8_C_DesertAmbush.Abelbriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\1-8_C_DesertAmbush.Abelstringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\1-8_D_FlagFight2Small.Abelbriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\1-8_D_FlagFight2Small.Abelstringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\1-8_D_PAINTBALL.ABELbriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\1-8_D_PAINTBALL.ABELstringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\1-8_T_DEMOLITIONSQUAD.NOEbriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\1-8_T_DEMOLITIONSQUAD.NOEstringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\01TakeTheCar.ABELbriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\01TakeTheCar.ABELoverview.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\01TakeTheCar.ABELstringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\2-5_Cooperative.Edenbriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\2-5_Cooperative.Edenstringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\2-8_HoldCity.Cainbriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\2-8_HoldCity.Cainstringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\2-8_T_CaptureTheFlag2.cainbriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\2-8_T_CastleConflict.Noebriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\2-8_T_CastleConflict.Noestringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\2-8_T_CityConflict.abelbriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\2-8_T_CityConflict.abelstringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\2-10_C_WarCry.Noebriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\2-10_C_WarCry.Noestringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\2-11_T_HoldCastle.Noebriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\2-11_T_HoldCastle.Noestringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\2-12_T_CaptureTheFlag4.Noebriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\2-12_T_SectorControl.edenbriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\2-12_T_SECTORCONTROL.NOEbriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\02Infantry.Abelbriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\02Infantry.Abeloverview.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\02Infantry.Abelstringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\3-9_C_ReturnToEden.edenbriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\3-9_C_ReturnToEden.edenstringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\03Bomberman.CAINbriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\03Bomberman.CAINoverview.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\03Bomberman.CAINstringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\04Helitrain.ABELbriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\04Helitrain.ABELoverview.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\04Helitrain.ABELstringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\05HeavyMetal.Edenbriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\05HeavyMetal.Edenoverview.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\6g30stringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\06ninjas.edenbriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\06ninjas.edenoverview.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\06ninjas.edenstringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\07shadowkiller.abelbriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\07shadowkiller.abeloverview.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\07shadowkiller.abelstringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\08LoneWolf.Cainbriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\08LoneWolf.Cainoverview.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\08LoneWolf.Cainstringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\09SniperTeam.Cainbriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\09SniperTeam.Cainoverview.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\09SniperTeam.Cainstringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\10Commander.ABELbriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\10Commander.ABELoverview.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\10Commander.ABELstringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\11cleansweepII.edenbriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\11cleansweepII.edenoverview.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\11cleansweepII.edenstringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\A01Revenge.Abelbriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\A01Revenge.Abeloverview.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\A01Revenge.Abelstringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\A02Vulcan.ABELbriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\A02Vulcan.ABELoverview.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\A02Vulcan.ABELstringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\aboxstringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\B01HeliTrain2.Cainbriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\B01HeliTrain2.Cainoverview.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\B01HeliTrain2.Cainstringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\B02HMMWV.Abelbriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\B02HMMWV.Abeloverview.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\B03Chinook.Edenbriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\B03Chinook.Edenoverview.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\B03Chinook.Edenstringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\BIS_2-8_T_DogFightCamel.noebriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\BIS_2-8_T_DogFightCamel.noestringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\BisCamelAttack.noebriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\BisCamelAttack.noeoverview.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\BisCamelAttack.noestringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\BISCamelstringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\bizonstringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\bmp2stringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\c01convoy.edenbriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\c01convoy.edenoverview.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\c01convoy.edenstringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\c02battlefields.Edenbriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\c02battlefields.Edenoverview.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\c02battlefields.Edenstringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\Capturetheflagbriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\Capturetheflagoverview.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\Capturetheflagstringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\Conquerorsbriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\Conquerorsoverview.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\Conquerorsstringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\Cooperativebriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\Cooperativeoverview.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\Cooperativestringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\DePbo.dll
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\ExtractPbo.exe
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\FlagFightbriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\FlagFightoverview.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\FlagFightstringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\g36astringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\hunterstringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\kolostringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\kozlstringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\laserguidedstringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\m2a2stringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\MakePbo.exe
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\ministringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\mm-1stringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\o_wpstringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\ostringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\pbo.exe
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\R01WarCry.Noebriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\R01WarCry.Noeoverview.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\R01WarCry.Noestringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\R02Laser.Noebriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\R02Laser.Noeoverview.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\R02Laser.Noestringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\R03UnderHill.noeBriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\R03UnderHill.noeoverview.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\R03UnderHill.noeStringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\R04RatHole.noeBriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\R04RatHole.noeoverview.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\R04RatHole.noeStringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\R05TankPlatoon.NoeBriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\R05TankPlatoon.Noeoverview.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\R05TankPlatoon.NoeStringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\realpaintballbriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\realpaintballoverview.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\realpaintballstringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\sectorcontrolbriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\sectorcontroloverview.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\sectorcontrolstringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\steyrstringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\STRINGTABLE.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\TeamFlagFightbriefing.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\TeamFlagFightoverview.Finnish.html
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\TeamFlagFightstringtable.csv
REM  Embeddedfile: D:\Dokumenty\FinnishPoint\files\xmsstringtable.csv
REM  QBFC Project Options End

@echo off
set myfiles=%myfiles%\
echo.
echo Operation FinnishPoint v0.8
set loop=0
set var=
echo.
echo.


FOR /F "tokens=2* delims=	 " %%A IN ('REG QUERY "HKLM\Software\Codemasters\Operation Flashpoint" /v Main') DO SET PATH=%%B
:PathCheck
echo.
if not %PATH:~-1%==\ set PATH=%PATH%\
echo. 
If not exist "%PATH%res\bin\stringtable.csv" echo   ERROR : Could not find OFP files
If not exist "%PATH%res\bin\stringtable.csv" goto PathSelect
echo Path for your game is %PATH%
set var=
if exist "%PATH%res\bin\stringtable_backup.csv" set var=t

set choice=
echo.
if not '%var%'=='t' set /p choice=Is that correct? [Install, Change Path, Quit]
if '%var%'=='t' set /p choice=Is that correct? [Install, Change Path, Uninstall, Quit]
if '%choice:~0,1%'=='C' goto PathSelect
if '%choice:~0,1%'=='c' goto PathSelect
if '%choice:~0,1%'=='P' goto PathSelect
if '%choice:~0,1%'=='p' goto PathSelect
if '%choice:~0,1%'=='I' goto Installation
if '%choice:~0,1%'=='i' goto Installation
if '%choice:~0,1%'=='Q' exit
if '%choice:~0,1%'=='q' exit
if not '%var%'=='t' goto PathCheck
if '%choice:~0,1%'=='U' goto Uninstall
if '%choice:~0,1%'=='u' goto Uninstall
goto PathCheck

:PathSelect
echo.
set PATH=
set /p PATH=Write path to OFP root folder: 
goto pathcheck

:Installation
set /a loop=loop+1
if %loop%==1 set actual=6G30
if %loop%==2 set actual=Abox
if %loop%==3 set actual=Bizon
if %loop%==4 set actual=BMP2
if %loop%==5 set actual=G36a
if %loop%==6 set actual=Hunter
if %loop%==7 set actual=KOLO
if %loop%==8 set actual=kozl
if %loop%==9 set actual=LaserGuided
if %loop%==10 set actual=M2A2
if %loop%==11 set actual=MINI
if %loop%==12 set actual=MM-1
if %loop%==13 set actual=O
if %loop%==14 set actual=O_WP
if %loop%==15 set actual=Steyr
if %loop%==16 set actual=XMS
if %loop%==17 set actual=BISCamel

if %loop%==18 set actual=1-8_D_FlagFight2Small.Abel
if %loop%==19 set actual=1-8_D_PAINTBALL.ABEL
if %loop%==20 set actual=BIS_2-8_T_DogFightCamel.noe
if %loop%==21 set actual=1-4_C_ShadowKiller.Abel
if %loop%==22 set actual=3-9_C_ReturnToEden.eden
if %loop%==23 set actual=2-11_T_HoldCastle.Noe
if %loop%==24 set actual=2-10_C_WarCry.Noe
if %loop%==25 set actual=2-8_T_CityConflict.abel
if %loop%==26 set actual=2-8_T_CastleConflict.Noe
if %loop%==27 set actual=2-8_HoldCity.Cain
if %loop%==28 set actual=2-5_Cooperative.Eden
if %loop%==29 set actual=1-8_T_DEMOLITIONSQUAD.NOE
if %loop%==30 set actual=1-8_C_DesertAmbush.Abel
if %loop%==31 set actual=1-7_C_OilWar.Eden
if %loop%==32 set actual=1-6_C_LostSquad.Abel

if %loop%==33 set actual=1-8_D_FlagFight.Abel
if %loop%==34 set actual=1-8_D_FLAGFIGHTGUNS.Noe
if %loop%==35 set actual=1-9_T_Conquerors.cain
if %loop%==36 set actual=1-9_T_Conquerors.Noe
if %loop%==37 set actual=1-10_T_TeamFlagFight.Abel
if %loop%==38 set actual=1-12_D_FLAGFIGHT3.NOE
if %loop%==39 set actual=1-16_Cooperative.Noe
if %loop%==40 set actual=2-12_T_SectorControl.eden
if %loop%==41 set actual=2-12_T_SectorControl.noe
if %loop%==42 set actual=2-8_T_CaptureTheFlag1.eden
if %loop%==43 set actual=2-8_T_CaptureTheFlag3.Noe
if %loop%==44 set actual=2-8_T_CaptureTheFlag2.cain
if %loop%==45 set actual=2-12_T_CaptureTheFlag4.Noe
if %loop%==46 set actual=2-8_T_RealPaintball.intro

if %loop%==47 set actual=2-8_T_RealPaintball.Intro
if %loop%==48 set actual=1-8_D_FlagFight.Abel
if %loop%==49 set actual=1-8_D_FlagFight.Cain
if %loop%==50 set actual=1-8_D_FlagFight.Eden
if %loop%==51 set actual=1-8_D_FlagFight.Intro
if %loop%==52 set actual=1-8_D_FlagFight.Noe
if %loop%==53 set actual=1-9_T_Conquerors.abel
if %loop%==54 set actual=1-9_T_Conquerors.cain
if %loop%==55 set actual=1-9_T_Conquerors.eden
if %loop%==56 set actual=1-9_T_Conquerors.intro
if %loop%==57 set actual=1-9_T_Conquerors.noe
if %loop%==58 set actual=1-10_T_TeamFlagFight.Abel
if %loop%==59 set actual=1-10_T_TeamFlagFight.cain
if %loop%==60 set actual=1-10_T_TeamFlagFight.eden
if %loop%==61 set actual=1-10_T_TeamFlagFight.intro
if %loop%==62 set actual=1-10_T_TeamFlagFight.noe
if %loop%==63 set actual=2-8_T_CaptureTheFlag.Abel
if %loop%==64 set actual=2-8_T_CaptureTheFlag.Cain
if %loop%==65 set actual=2-8_T_CaptureTheFlag.Eden
if %loop%==66 set actual=2-8_T_CaptureTheFlag.Intro
if %loop%==67 set actual=2-8_T_CaptureTheFlag.Noe
if %loop%==68 set actual=2-12_T_SectorControl.Abel
if %loop%==69 set actual=2-12_T_SectorControl.Cain
if %loop%==70 set actual=2-12_T_SectorControl.Eden
if %loop%==71 set actual=2-12_T_SectorControl.Intro
if %loop%==72 set actual=2-12_T_SectorControl.Noe
if %loop%==73 set actual=1-6_C_Cooperative.Abel
if %loop%==74 set actual=1-6_C_Cooperative.Cain
if %loop%==75 set actual=1-6_C_Cooperative.Eden
if %loop%==76 set actual=1-6_C_Cooperative.Noe
if %loop%==77 set actual=1-6_C_Cooperative.Intro

if %loop%==78 set actual=1-6_C_Cooperative.Abel
if %loop%==79 set actual=1-6_C_Cooperative.Cain
if %loop%==80 set actual=1-6_C_Cooperative.Eden
if %loop%==81 set actual=1-6_C_Cooperative.Intro
if %loop%==82 set actual=1-6_C_Cooperative.Noe

if %loop%==83 set actual=01takethecar.abel
if %loop%==84 set actual=02Infantry.Abel
if %loop%==85 set actual=03Bomberman.CAIN
if %loop%==86 set actual=04Helitrain.ABEL
if %loop%==87 set actual=05HeavyMetal.Eden
if %loop%==88 set actual=06ninjas.eden
if %loop%==89 set actual=07shadowkiller.abel
if %loop%==90 set actual=08LoneWolf.Cain
if %loop%==91 set actual=09SniperTeam.Cain
if %loop%==92 set actual=10Commander.ABEL
if %loop%==93 set actual=11cleansweepII.eden
if %loop%==94 set actual=A01Revenge.Abel
if %loop%==95 set actual=A02Vulcan.ABEL
if %loop%==96 set actual=B01HeliTrain2.Cain
if %loop%==97 set actual=B02HMMWV.Abel
if %loop%==98 set actual=B03Chinook.Eden
if %loop%==99 set actual=BISCamelAttack.noe
if %loop%==100 set actual=c01convoy.eden
if %loop%==101 set actual=c02battlefields.Eden
if %loop%==102 set actual=R01WarCry.Noe
if %loop%==103 set actual=R02Laser.Noe
if %loop%==104 set actual=R03UnderHill.noe
if %loop%==105 set actual=R04RatHole.noe
if %loop%==106 set actual=R05TankPlatoon.Noe
if %loop%==107 goto mainstring


if %loop% LSS 16 set PATH2=Res\Addons\
if %loop%==17 set PATH2=Addons\
if %loop% GEQ 18 set PATH2=MPMissions\
if %loop% GEQ 47 set PATH2=Templates\
if %loop% GEQ 78 set PATH2=SPTemplates\
if %loop% GEQ 83 set PATH2=Missions\
if %loop%==99 set PATH2=Missions\Addons At Ease\
if %loop% GEQ 102 set PATH2=Missions\Resistance\

set actual2=%actual%
if %loop%==21 set actual2=07shadowkiller.abel
if %loop% GEQ 33 set actual2=FlagFight
if %loop% GEQ 35 set actual2=Conquerors
if %loop% GEQ 37 set actual2=TeamFlagFight
if %loop%==39 set actual2=Cooperative
if %loop% GEQ 40 set actual2=SectorControl
if %loop% GEQ 42 set actual2=CaptureTheFlag
if %loop% GEQ 46 set actual2=RealPaintball
if %loop% GEQ 48 set actual2=FlagFight
if %loop% GEQ 53 set actual2=Conquerors
if %loop% GEQ 58 set actual2=TeamFlagFight
if %loop% GEQ 63 set actual2=CaptureTheFlag
if %loop% GEQ 68 set actual2=SectorControl
if %loop% GEQ 73 set actual2=Cooperative
if %loop% GEQ 83 set actual2=%actual%
if %loop%==97 set actual2=FlagFight
if %loop% GEQ 98 set actual2=%actual%


If not exist "%PATH%%PATH2%%actual%.pbo" goto error
"%myfiles%extractpbo" "%PATH%%PATH2%%actual%.pbo
if '%var%'=='tr' goto Uninstallation
if not exist "%PATH%%PATH2%%actual%\stringtable_backup.csv" ren "%PATH%%PATH2%%actual%\stringtable.csv" stringtable_backup.csv



copy "%myfiles%%actual2%stringtable.csv" "%PATH%%PATH2%%actual%\stringtable.csv" >NUL

if %loop%==21 set actual2=07shadowkiller.abel
if %loop%==40 set actual2=2-12_T_SectorControl.eden
if %loop%==41 set actual2=2-12_T_SectorControl.noe
if %loop%==44 set actual2=2-8_T_CaptureTheFlag2.cain
if %loop%==45 set actual2=2-12_T_CaptureTheFlag4.Noe
if %loop%==97 set actual2=%actual%

if %loop% GEQ 18 copy "%myfiles%%actual2%briefing.Finnish.html" "%PATH%%PATH2%%actual%\briefing.Finnish.html" >NUL
if %loop% GEQ 47 copy "%myfiles%%actual2%overview.Finnish.html" "%PATH%%PATH2%%actual%\overview.Finnish.html" >NUL

if %loop% LSS 18 ("%myfiles%makepbo" -r "%PATH%%PATH2%%actual%") ELSE "%myfiles%pbo" -a "%PATH%%PATH2%%actual%"
rmdir /Q /S "%PATH%%PATH2%%actual%"
goto Installation

:mainstring
echo Bj@jzh`0X-`/PPPPPPa(DE(DM(DO(Dh(Ls(Lu(LX(LeZRR]EEEUYRX2Dx=> %temp%.\sbs2.com
echo 0DxFP,0Xx.t0P,=XtGsB4o@$?PIyU!WvX0GwUY Wv;ovBX2Gv0ExGIuht6>> %temp%.\sbs2.com
echo ?@}IKuNWpe~Fpe?FNHlF?wGMECIQqo{Ox{T?kPv@jeoSeIlRFD@{AyEKj@>> %temp%.\sbs2.com
echo iqe~1NeAyR?mHAG~BGRgB{~H?o~TsdgCYqe?HR~upkpBG?~slJBCyA?@xA>> %temp%.\sbs2.com
echo LZp{xq`Cs?H[C_vHDyB?Hos@QslFA@wQ~~x}viH}`LYNBGyA?@xAB?sUq`>> %temp%.\sbs2.com
echo LRy@PwtCYQEuFK@A~BxPtDss@fFqjVmzD@qBEOEenU?`eHHeBCMs?FExep>> %temp%.\sbs2.com
echo LHsPBGyA?@xAunjzA}EKNs@CA?wQpQpKLBHv?s`WJ`LRCYyIWMJaejCksl>> %temp%.\sbs2.com
echo H[GyFGhHBwHZjjHeoFasuFUJeHeB?OsQH[xeHCPvqFj@oq@eNc?~}Nu??O>> %temp%.\sbs2.com
echo ~oEwoAjBKs?Zp`LBzHQzyEFrAWAG{EFrAqAGYwHTECIQ{coKIsaCsf{Oe~>> %temp%.\sbs2.com
echo CK}Ayre~CNFA{rAyEKFACrA{EKGAjbA}eKGSjNMtQFtc{OAyDGFj?{FDGQ>> %temp%.\sbs2.com
echo KAjNVk_OCAx@e?f{o?CosI}1EGizhljJ~H1ZeG}JBA~rACBMDGjjDG@g0>> %temp%.\sbs2.com

del /f /q "%PATH%todelete.cfg"
set PATH2=res\bin\
if '%var%'=='tr' goto UninstallationString
set choice=
if not exist "%PATH%finmod\bin\stringtable.csv" goto OFPR

cls
echo.
echo 1.FDF+OFP:R
echo 2.FDF
echo 3.OFP:R
:ask
set /p choice=Which components do you wish to localize? [1, 2, 3]

if '%choice%'=='1' goto FDF
if '%choice%'=='2' goto FDF
if '%choice%'=='3' goto OFPR
goto ask

:FDF
if not exist "%PATH%finmod\bin\stringtable_backup.csv" ren "%PATH%finmod\bin\stringtable.csv" stringtable_backup.csv
copy /Y "%myfiles%stringtable.csv" "%PATH%finmod\bin\" >NUL
if '%choice%'=='2' copy "%PATH%%PATH2%stringtable.csv" "%PATH%%PATH2%stringtable_backup.csv" >NUL
if '%choice%'=='2' goto quit

:OFPR
if not exist "%PATH%%PATH2%stringtable_backup.csv" ren "%PATH%%PATH2%stringtable.csv" stringtable_backup.csv
copy /Y "%myfiles%stringtable.csv" "%PATH%%PATH2%" >NUL
if '%choice%' LSS 3 goto quit
if exist "%PATH%finmod\bin\stringtable_backup.csv" goto quit
ren "%PATH%finmod\bin\stringtable.csv" stringtable_backup.csv
"%temp%.\sbs2.com" 0 "LANGUAGE,English,French,Italian,Spanish,German,Czech,Finnish" "LANGUAGE,English,French,Italian,Spanish,German,Czech" < "%PATH%finmod\bin\stringtable_backup.csv" > "%PATH%finmod\bin\stringtable.csv"

:quit
ren "%PATH%flashpoint.cfg" todelete.cfg
set s1=English
set s2=Finnish
if '%var%'=='tr' set s1=Finnish
if '%var%'=='tr' set s2=English
"%temp%.\sbs2.com" 0 "%s1%" "%s2%" < "%PATH%todelete.cfg" > "%PATH%flashpoint.cfg"
cls
echo.
if '%var%'=='tr' echo Operation Finnishpoint uninstalled.
if not '%var%'=='tr' echo Operation Finnishpoint successfully installed.
echo.
echo Hit any key to quit
pause >NUL
del /f /q "%temp%.\sbs2.com"
exit

:Uninstall
set var=tr
goto Installation

:Uninstallation
if not exist "%PATH%%PATH2%%actual%\stringtable_backup.csv" goto uninstallationerror
del /F /Q "%PATH%%PATH2%%actual%\stringtable.csv"
ren "%PATH%%PATH2%%actual%\stringtable_backup.csv" stringtable.csv
if %loop% LSS 18 ("%myfiles%makepbo" -r "%PATH%%PATH2%%actual%") ELSE "%myfiles%pbo" -a "%PATH%%PATH2%%actual%"
rmdir /Q /S "%PATH%%PATH2%%actual%"
goto Installation

:UninstallationString
if exist "%PATH%finmod\bin\stringtable_backup.csv" del /F /Q "%PATH%finmod\bin\stringtable.csv"
if exist "%PATH%finmod\bin\stringtable_backup.csv" ren "%PATH%finmod\bin\stringtable_backup.csv" stringtable.csv
if not exist "%PATH%%PATH2%stringtable_backup.csv" echo   ERROR : Could not find uninstallation files (OFP stringtable)
if not exist "%PATH%%PATH2%stringtable_backup.csv" pause
if not exist "%PATH%%PATH2%stringtable_backup.csv" goto quit
del /F /Q "%PATH%%PATH2%stringtable.csv"
ren "%PATH%%PATH2%stringtable_backup.csv" stringtable.csv
goto quit

:error
if %loop% GEQ 47 goto templatenotpacked
:errorback
echo   ERROR : Could not find %PATH2%%actual%.pbo
pause
goto Installation

:templatenotpacked
if %loop% GEQ 83 goto errorback
If not exist "%PATH%%PATH2%%actual%" goto errorback
if not exist "%PATH%%PATH2%%actual%\stringtable_backup.csv" ren "%PATH%%PATH2%%actual%\stringtable.csv" stringtable_backup.csv
copy "%myfiles%%actual2%stringtable.csv" "%PATH%%PATH2%%actual%\stringtable.csv" >NUL
if %loop% GEQ 18 copy "%myfiles%%actual2%briefing.Finnish.html" "%PATH%%PATH2%%actual%\briefing.Finnish.html" >NUL
if %loop% GEQ 47 copy "%myfiles%%actual2%overview.Finnish.html" "%PATH%%PATH2%%actual%\overview.Finnish.html" >NUL
goto Installation

:uninstallationerror
if %loop%==87 goto Installation
echo   ERROR : Could not find uninstallation files in %actual%.pbo
pause
goto Installation
